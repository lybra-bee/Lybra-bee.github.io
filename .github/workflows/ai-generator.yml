name: AI Content Generator

on:
  workflow_dispatch:
  schedule:
    - cron: '0 12 * * 1'  # –ö–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 12:00 UTC

permissions:
  contents: write

jobs:
  generate:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GIT_TOKEN }}
          fetch-depth: 0

      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Install dependencies
        run: pip install requests

      - name: Create content directory
        run: mkdir -p content/posts

      - name: Generate AI content
        env:
          OPENROUTER_API_KEY: ${{ secrets.OPENROUTER_API_KEY }}
        run: |
          echo "=== AI CONTENT GENERATION ==="
          
          # –°–ª—É—á–∞–π–Ω—ã–µ —Ç–µ–º—ã –¥–ª—è —Å—Ç–∞—Ç–µ–π
          TOPICS=(
            "–í–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏ 2024: React, Vue, Svelte —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ"
            "Serverless –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π"
            "–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –≤ –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ"
            "–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (PWA) –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏"
            "–ö–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π"
            "WebAssembly –∏ –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"
            "JAMstack –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã"
            "–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã vs –º–æ–Ω–æ–ª–∏—Ç—ã –≤ –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ"
          )
          
          SELECTED_TOPIC=${TOPICS[$RANDOM % ${#TOPICS[@]}]}
          echo "üìù –¢–µ–º–∞: $SELECTED_TOPIC"
          
          # –ü–æ–ø—ã—Ç–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ OpenRouter (—Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫)
          if [ -n "$OPENROUTER_API_KEY" ] && [ "$OPENROUTER_API_KEY" != "" ]; then
            echo "üîê –ò—Å–ø–æ–ª—å–∑—É–µ–º OpenRouter API"
            
            FREE_MODELS=(
              "google/palm-2-chat-bison-32k:free"
              "mistralai/mistral-7b-instruct:free" 
              "huggingfaceh4/zephyr-7b-beta:free"
            )
            
            SELECTED_MODEL=${FREE_MODELS[$RANDOM % ${#FREE_MODELS[@]}]}
            echo "üéØ –ú–æ–¥–µ–ª—å: $SELECTED_MODEL"
            
            response=$(curl -s -X POST \
              -H "Content-Type: application/json" \
              -H "Authorization: Bearer $OPENROUTER_API_KEY" \
              -H "HTTP-Referer: https://github.com" \
              -H "X-Title: AI Blog Generator" \
              -d '{
                "model": "'"$SELECTED_MODEL"'",
                "messages": [
                  {
                    "role": "user", 
                    "content": "–ù–∞–ø–∏—à–∏ –∫—Ä–∞—Ç–∫–∏–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞–±–∑–∞—Ü –Ω–∞ —Ç–µ–º—É: '"$SELECTED_TOPIC"'. –ò—Å–ø–æ–ª—å–∑—É–π Markdown, **–∂–∏—Ä–Ω—ã–π —à—Ä–∏—Ñ—Ç** –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤. –û—Ç–≤–µ—Ç –Ω–∞ —Ä—É—Å—Å–∫–æ–º, –º–∞–∫—Å–∏–º—É–º 200 —Å–ª–æ–≤."
                  }
                ],
                "max_tokens": 300,
                "temperature": 0.7
              }' \
              "https://openrouter.ai/api/v1/chat/completions" 2>/dev/null || echo "API_ERROR")
            
            if [[ "$response" == *"choices"* ]] && [[ "$response" != *"error"* ]]; then
              echo "‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ API —É—Å–ø–µ—à–Ω–∞!"
              CONTENT=$(echo "$response" | python3 -c "
import json, sys
try:
    data = json.load(sys.stdin)
    content = data['choices'][0]['message']['content']
    # –û—á–∏—â–∞–µ–º –æ—Ç –ª–∏—à–Ω–∏—Ö –∫–∞–≤—ã—á–µ–∫
    content = content.replace('\"\"\"', '').replace('\'\'\'', '')
    print(content)
except Exception as e:
    print('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –æ—Ç–≤–µ—Ç–∞ API:', str(e))
")
            else
              echo "‚ùå –û—à–∏–±–∫–∞ API, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback"
              CONTENT=""
            fi
          else
            echo "‚ö†Ô∏è API –∫–ª—é—á –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é"
            CONTENT=""
          fi
          
          # Fallback –∫–æ–Ω—Ç–µ–Ω—Ç –µ—Å–ª–∏ API –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª
          if [ -z "$CONTENT" ] || [ "$CONTENT" == "–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –æ—Ç–≤–µ—Ç–∞ API" ]; then
            echo "üîÑ –ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é..."
            case $SELECTED_TOPIC in
              *—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏*)
                CONTENT="## –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏ 2024\n\n–í 2024 –≥–æ–¥—É **React** –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞—Ç—å —Å –Ω–æ–≤—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ Concurrent Rendering. **Vue 3** —Å Composition API –Ω–∞–±–∏—Ä–∞–µ—Ç –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π. **Svelte** –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç innovative –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º runtime overhead.\n\n**Next.js** –∏ **Nuxt.js** –æ—Å—Ç–∞—é—Ç—Å—è –ª–∏–¥–µ—Ä–∞–º–∏ –¥–ª—è full-stack —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏."
                ;;
              *Serverless*)
                CONTENT="## Serverless –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞\n\nServerless —Ä–µ–≤–æ–ª—é—Ü–∏–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É, –ø–æ–∑–≤–æ–ª—è—è focus –Ω–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–µ –≤–º–µ—Å—Ç–æ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã. **AWS Lambda**, **Cloud Functions** –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ pay-per-use –º–æ–¥–µ–ª—å.\n\n–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞: reduced operational overhead –∏ cost efficiency."
                ;;
              *–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç*)
                CONTENT="## AI –≤ –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ\n\n–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É: **GPT-4** –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞, **Copilot** –¥–ª—è assistance –≤ coding, **AI-powered chatbots** –¥–ª—è customer service.\n\n–ù–æ–≤—ã–µ API like **WebGPU** –ø–æ–∑–≤–æ–ª—è—é—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å ML –º–æ–¥–µ–ª–∏ –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ."
                ;;
              *PWA*)
                CONTENT="## –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è\n\n**PWA** —Å–æ—á–µ—Ç–∞—é—Ç –ª—É—á—à–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ web –∏ mobile –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π. Offline —Ä–∞–±–æ—Ç–∞ —á–µ—Ä–µ–∑ Service Workers, push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ app-like –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.\n\n–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏: Web Share API, Background Sync –∏ hardware access –¥–µ–ª–∞—é—Ç PWA –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π –∑–∞–º–µ–Ω–æ–π –Ω–∞—Ç–∏–≤–Ω—ã–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º."
                ;;
              *)
                CONTENT="## $SELECTED_TOPIC\n\n–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –≤ 2024 —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç—Å—è rapid innovation. **React 18** –∏ **Vue 3** –∑–∞–¥–∞—é—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã frontend —Ä–∞–∑–≤–∏—Ç–∏—è. **Serverless –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** reduces operational complexity.\n\n**WebAssembly** enables near-native performance –≤ –±—Ä–∞—É–∑–µ—Ä–µ. **AI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è must-have –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏."
                ;;
            esac
          fi
          
          echo "üìÑ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç:"
          echo "$CONTENT"
          
          # –°–æ–∑–¥–∞–µ–º —Å—Ç–∞—Ç—å—é
          DATE=$(date +%Y-%m-%d)
          TIMESTAMP=$(date +%H-%M-%S)
          SLUG=$(echo "$SELECTED_TOPIC" | tr ' ' '-' | tr '–ê-–Ø–∞-—è' 'A-Za-z' | tr -cd '[:alnum:]-' | head -c 40)
          FILE="content/posts/${DATE}-${SLUG}.md"
          
          cat > "$FILE" << EOF
---
title: "$SELECTED_TOPIC"
date: $(date -u +"%Y-%m-%dT%H:%M:%SZ")
draft: false
description: "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç—å—è –æ $SELECTED_TOPIC"
tags: ["–≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞", "—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏", "2024"]
---

# $SELECTED_TOPIC

$CONTENT

---

### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

- **–ú–æ–¥–µ–ª—å AI:** ${SELECTED_MODEL:-"–õ–æ–∫–∞–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è"}
- **–î–∞—Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:** $(date +"%d.%m.%Y %H:%M")
- **–¢–µ–º–∞:** $SELECTED_TOPIC
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ

> *–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ GitHub Actions*
EOF
          
          echo "‚úÖ –§–∞–π–ª —Å–æ–∑–¥–∞–Ω: $FILE"

      - name: Commit and push changes
        run: |
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git config --global user.name "github-actions[bot]"
          
          git add content/posts/
          git status
          
          if git diff --staged --quiet; then
            echo "‚ùå –ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è –∫–æ–º–º–∏—Ç–∞"
            echo "–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–∞–ø–∫–∏ content/posts/:"
            ls -la content/posts/
            exit 0
          fi
          
          git commit -m "ü§ñ AI –°—Ç–∞—Ç—å—è: $SELECTED_TOPIC [$(date +"%d.%m.%Y %H:%M")]"
          git pull origin main --rebase
          git push origin main
          echo "‚úÖ –°—Ç–∞—Ç—å—è —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∏ –∑–∞–ø—É—â–µ–Ω–∞!"

      - name: Verify results
        run: |
          echo "=== –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ì–ï–ù–ï–†–ê–¶–ò–ò ==="
          echo "–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:"
          find content/posts/ -name "*.md" -exec ls -la {} \; | tail -3
          echo "–í—Å–µ–≥–æ —Å—Ç–∞—Ç–µ–π –≤ –ø–∞–ø–∫–µ:"
          find content/posts/ -name "*.md" | wc -l
