name: AI Content Generator

on:
  workflow_dispatch:
  schedule:
    - cron: '0 12 * * 1'  # –ö–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 12:00 UTC

permissions:
  contents: write

jobs:
  generate:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Install dependencies
        run: pip install requests

      - name: Create content directory
        run: mkdir -p content/posts

      - name: Generate with OpenRouter AI
        env:
          OPENROUTER_API_KEY: ${{ secrets.OPENROUTER_API_KEY }}
        run: |
          echo "=== –†–ï–ê–õ–¨–ù–ê–Ø –ì–ï–ù–ï–†–ê–¶–ò–Ø –ß–ï–†–ï–ó OPENROUTER ==="
          
          # –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏ –Ω–∞ OpenRouter
          FREE_MODELS=(
            "google/palm-2-chat-bison-32k:free"
            "mistralai/mistral-7b-instruct:free" 
            "huggingfaceh4/zephyr-7b-beta:free"
            "anthropic/claude-3-haiku:free"
          )
          
          # –°–ª—É—á–∞–π–Ω—ã–µ —Ç–µ–º—ã –¥–ª—è —Å—Ç–∞—Ç–µ–π
          TOPICS=(
            "–í–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏ 2024: React, Vue, Svelte —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ"
            "Serverless –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π"
            "–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –≤ –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ"
            "–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (PWA) –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏"
            "–ö–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π"
            "WebAssembly –∏ –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"
            "JAMstack –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã"
            "–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã vs –º–æ–Ω–æ–ª–∏—Ç—ã –≤ –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ"
          )
          
          SELECTED_MODEL=${FREE_MODELS[$RANDOM % ${#FREE_MODELS[@]}]}
          SELECTED_TOPIC=${TOPICS[$RANDOM % ${#TOPICS[@]}]}
          
          echo "üéØ –ú–æ–¥–µ–ª—å: $SELECTED_MODEL"
          echo "üìù –¢–µ–º–∞: $SELECTED_TOPIC"
          
          # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ OpenRouter
          response=$(curl -s -X POST \
            -H "Content-Type: application/json" \
            -H "Authorization: Bearer $OPENROUTER_API_KEY" \
            -H "HTTP-Referer: https://lybra-bee.github.io" \
            -H "X-Title: AI Blog Generator" \
            -d '{
              "model": "'"$SELECTED_MODEL"'",
              "messages": [
                {
                  "role": "user", 
                  "content": "–ù–∞–ø–∏—à–∏ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞–±–∑–∞—Ü –Ω–∞ —Ç–µ–º—É: '"$SELECTED_TOPIC"'. –ò—Å–ø–æ–ª—å–∑—É–π Markdown –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –ø–æ–¥–∑–∞–≥–æ–ª–æ–≤–∫–∏ **–∂–∏—Ä–Ω—ã–π —à—Ä–∏—Ñ—Ç** –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤. –û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ."
                }
              ],
              "max_tokens": 500,
              "temperature": 0.8,
              "top_p": 0.9
            }' \
            "https://openrouter.ai/api/v1/chat/completions" 2>/dev/null || echo "API_ERROR")
          
          if [[ "$response" == *"choices"* ]] && [[ "$response" != *"error"* ]]; then
            echo "‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!"
            CONTENT=$(echo "$response" | python3 -c "
import json, sys
try:
    data = json.load(sys.stdin)
    print(data['choices'][0]['message']['content'])
except:
    print('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –æ—Ç–≤–µ—Ç–∞ API')
")
          else
            echo "‚ùå –û—à–∏–±–∫–∞ API: $response"
            echo "üîÑ –ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é..."
            # –õ–æ–∫–∞–ª—å–Ω—ã–π fallback –∫–æ–Ω—Ç–µ–Ω—Ç
            case $SELECTED_TOPIC in
              *—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏*)
                CONTENT="## –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏ 2024\n\n–í 2024 –≥–æ–¥—É **React** –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞—Ç—å —Å –Ω–æ–≤—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ like Concurrent Rendering. **Vue 3** —Å Composition API –Ω–∞–±–∏—Ä–∞–µ—Ç –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π. **Svelte** –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç innovative –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º runtime overhead.\n\n**Next.js** –∏ **Nuxt.js** –æ—Å—Ç–∞—é—Ç—Å—è –ª–∏–¥–µ—Ä–∞–º–∏ –¥–ª—è full-stack —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –ø—Ä–µ–¥–ª–∞–≥–∞—è SSR, SSG –∏ API routes –∏–∑ –∫–æ—Ä–æ–±–∫–∏."
                ;;
              *Serverless*)
                CONTENT="## Serverless –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞\n\nServerless —Ä–µ–≤–æ–ª—é—Ü–∏–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É, –ø–æ–∑–≤–æ–ª—è—è focus –Ω–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–µ –≤–º–µ—Å—Ç–æ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã. **AWS Lambda**, **Cloud Functions** –∏ **Vercel Edge Functions** –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ pay-per-use –º–æ–¥–µ–ª—å.\n\n–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞: reduced operational overhead, cost efficiency –∏ –≥–ª–æ–±–∞–ª—å–Ω–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å. –í—ã–∑–æ–≤—ã: cold starts, debugging –∏ vendor lock-in."
                ;;
              *–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç*)
                CONTENT="## AI –≤ –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ\n\n–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É: **GPT-4** –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞, **Copilot** –¥–ª—è assistance –≤ coding, **AI-powered chatbots** –¥–ª—è customer service.\n\n–ù–æ–≤—ã–µ API like **WebGPU** –ø–æ–∑–≤–æ–ª—è—é—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å ML –º–æ–¥–µ–ª–∏ –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ. **AutoML** platforms —É–ø—Ä–æ—â–∞—é—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é AI –±–µ–∑ deep learning —ç–∫—Å–ø–µ—Ä—Ç–∏–∑—ã."
                ;;
              *)
                CONTENT="## $SELECTED_TOPIC\n\n–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –≤ 2024 —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç—Å—è rapid innovation. **React 18** –∏ **Vue 3** –∑–∞–¥–∞—é—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã frontend —Ä–∞–∑–≤–∏—Ç–∏—è. **Serverless –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** reduces operational complexity. **WebAssembly** enables near-native performance –≤ –±—Ä–∞—É–∑–µ—Ä–µ.\n\n**AI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è must-have –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏, –∞ **–∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞ –≤ era —É–≤–µ–ª–∏—á–∏–≤–∞—é—â–∏—Ö—Å—è –∞—Ç–∞–∫."
                ;;
            esac
          fi
          
          echo "üìÑ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç:"
          echo "$CONTENT"
          
          # –°–æ–∑–¥–∞–µ–º —Å—Ç–∞—Ç—å—é
          DATE=$(date +%Y-%m-%d)
          TIMESTAMP=$(date +%H-%M-%S)
          SLUG=$(echo "$SELECTED_TOPIC" | tr ' ' '-' | tr '–∞-—è' '–ê-–Ø' | tr -cd '[:alnum:]-' | head -c 50)
          FILE="content/posts/${DATE}-${SLUG}.md"
          
          cat > "$FILE" << EOF
---
title: "$SELECTED_TOPIC"
date: $(date -u +"%Y-%m-%dT%H:%M:%SZ")
draft: false
description: "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç—å—è –æ $SELECTED_TOPIC"
tags: ["–≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞", "—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏", "2024"]
---

# $SELECTED_TOPIC

$CONTENT

---

### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

- **–ú–æ–¥–µ–ª—å AI:** $SELECTED_MODEL
- **–î–∞—Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:** $(date +"%d.%m.%Y %H:%M")
- **–¢–µ–º–∞:** $SELECTED_TOPIC
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ

> *–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ OpenRouter API + GitHub Actions*
EOF
          
          echo "‚úÖ –§–∞–π–ª —Å–æ–∑–¥–∞–Ω: $FILE"
          echo "üìù –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä:"
          head -15 "$FILE"

      - name: Commit changes
        run: |
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git config --global user.name "github-actions[bot]"
          
          git add content/posts/
          git status
          
          if ! git diff --staged --quiet; then
            git commit -m "ü§ñ AI –°—Ç–∞—Ç—å—è: $(date +"%d.%m.%Y")"
            git pull origin main --rebase
            git push origin main
            echo "‚úÖ –°—Ç–∞—Ç—å—è –¥–æ–±–∞–≤–ª–µ–Ω–∞!"
          else
            echo "‚ùå –ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è –∫–æ–º–º–∏—Ç–∞"
            ls -la content/posts/
          fi

      - name: Final check
        run: |
          echo "=== –§–ò–ù–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê ==="
          echo "–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ñ–∞–π–ª—ã:"
          find content/posts/ -name "*.md" -type f -exec ls -la {} \; | tail -5
          echo "–í—Å–µ–≥–æ —Å—Ç–∞—Ç–µ–π:"
          find content/posts/ -name "*.md" -type f | wc -l
