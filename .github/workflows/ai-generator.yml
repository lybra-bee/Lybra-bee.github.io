name: AI Content Generator

on:
  workflow_dispatch:
  schedule:
    - cron: '0 12 * * 1'

permissions:
  contents: write

jobs:
  generate:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Install dependencies
        run: pip install requests

      - name: Create content directory
        run: mkdir -p content/posts

      - name: Generate content
        run: |
          echo "=== –ì–ï–ù–ï–†–ê–¶–ò–Ø –ö–û–ù–¢–ï–ù–¢–ê ==="
          
          # –õ–æ–∫–∞–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
          TOPICS=(
            "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏ –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤ 2024 –≥–æ–¥—É"
            "–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –≤ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö"
            "–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (PWA) –ø—Ä–æ—Ç–∏–≤ –Ω–∞—Ç–∏–≤–Ω—ã—Ö"
            "–°–µ—Ä–≤–µ—Äless –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏ –≤—ã–∑–æ–≤—ã"
            "–ö–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –≤–µ–±–µ"
          )
          
          # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é —Ç–µ–º—É
          SELECTED_TOPIC="${TOPICS[$((RANDOM % ${#TOPICS[@]}))]}"
          
          # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–º—ã
          case $SELECTED_TOPIC in
            *—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏*)
              CONTENT="–í 2024 –≥–æ–¥—É –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å –Ω–∞–±–∏—Ä–∞—é—Ç —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏ like React, Vue 3, –∏ Svelte. Next.js –∏ Nuxt.js –¥–æ–º–∏–Ω–∏—Ä—É—é—Ç –≤ full-stack —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ. –í–∞–∂–Ω—ã–º —Ç—Ä–µ–Ω–¥–æ–º —Å—Ç–∞–ª–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TypeScript –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞."
              ;;
            *–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç*)
              CONTENT="AI —Ä–µ–≤–æ–ª—é—Ü–∏–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É: —á–∞—Ç-–±–æ—Ç—ã –Ω–∞ –±–∞–∑–µ GPT, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–ø—ã—Ç–∞. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ML-–º–æ–¥–µ–ª–µ–π –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä —á–µ—Ä–µ–∑ WebAssembly."
              ;;
            *PWA*)
              CONTENT="PWA –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–∑–≤–∏–≤–∞—Ç—å—Å—è, –ø—Ä–µ–¥–ª–∞–≥–∞—è –Ω–∞—Ç–∏–≤–Ω—ã–π –æ–ø—ã—Ç –±–µ–∑ —É—Å—Ç–∞–Ω–æ–≤–∫–∏. –ù–æ–≤—ã–µ Web API –ø–æ–∑–≤–æ–ª—è—é—Ç –¥–æ—Å—Ç—É–ø –∫ hardware —Ñ—É–Ω–∫—Ü–∏—è–º. Offline-—Ä–∞–±–æ—Ç–∞ –∏ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º."
              ;;
            *—Å–µ—Ä–≤–µ—Äless*)
              CONTENT="Serverless –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–Ω–∏–∂–∞–µ—Ç –∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É. Cloud Functions, Edge Computing –∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –ø–æ–∑–≤–æ–ª—è—é—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –í–∞–∂–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞: AWS Lambda, Cloud Functions, Vercel."
              ;;
            *–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å*)
              CONTENT="–ö–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞: OWASP Top 10, HTTPS –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω, –∑–∞—â–∏—Ç–∞ –æ—Ç XSS –∏ CSRF –∞—Ç–∞–∫. –ë–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ 2FA —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π."
              ;;
            *)
              CONTENT="–í–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –≤ 2024 —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç—Å—è rapid evolution —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π. –ê–∫—Ü–µ–Ω—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç. JAMstack, AI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ serverless –¥–æ–º–∏–Ω–∏—Ä—É—é—Ç –≤ –∏–Ω–¥—É—Å—Ç—Ä–∏–∏."
              ;;
          esac
          
          echo "üìù –¢–µ–º–∞: $SELECTED_TOPIC"
          echo "üìÑ –ö–æ–Ω—Ç–µ–Ω—Ç: $CONTENT"
          
          # –°–æ–∑–¥–∞–µ–º —Å—Ç–∞—Ç—å—é
          DATE=$(date +%Y-%m-%d)
          TIMESTAMP=$(date +%H-%M-%S)
          FILE="content/posts/${DATE}-${TIMESTAMP}-ai-article.md"
          
          echo "---" > "$FILE"
          echo "title: \"$SELECTED_TOPIC\"" >> "$FILE"
          echo "date: $(date -u +"%Y-%m-%dT%H:%M:%SZ")" >> "$FILE"
          echo "draft: false" >> "$FILE"
          echo "description: \"–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç—å—è\"" >> "$FILE"
          echo "tags: [\"–≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞\", \"—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏\", \"2024\"]" >> "$FILE"
          echo "---" >> "$FILE"
          echo "" >> "$FILE"
          echo "# $SELECTED_TOPIC" >> "$FILE"
          echo "" >> "$FILE"
          echo "$CONTENT" >> "$FILE"
          echo "" >> "$FILE"
          echo "## üîß –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫" >> "$FILE"
          echo "" >> "$FILE"
          echo "- **–§—Ä–æ–Ω—Ç–µ–Ω–¥:** React, Vue, Svelte" >> "$FILE"
          echo "- **–ë—ç–∫–µ–Ω–¥:** Node.js, Python, Go" >> "$FILE"
          echo "- **–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL, MongoDB, Redis" >> "$FILE"
          echo "- **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:** Docker, Kubernetes, AWS" >> "$FILE"
          echo "" >> "$FILE"
          echo "> *–°—Ç–∞—Ç—å—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ $(date +"%d.%m.%Y")*" >> "$FILE"
          
          echo "‚úÖ –§–∞–π–ª —Å–æ–∑–¥–∞–Ω: $FILE"

      - name: Commit changes
        run: |
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git config --global user.name "github-actions[bot]"
          
          git add content/posts/
          
          if ! git diff --staged --quiet; then
            git commit -m "ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç–∞—Ç—å—è: $(date +"%d.%m.%Y")"
            git pull origin main --rebase
            git push origin main
            echo "‚úÖ –°—Ç–∞—Ç—å—è –¥–æ–±–∞–≤–ª–µ–Ω–∞!"
          else
            echo "‚ùå –ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è –∫–æ–º–º–∏—Ç–∞"
          fi

      - name: Final check
        run: |
          echo "=== –§–ò–ù–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê ==="
          echo "–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ñ–∞–π–ª—ã:"
          find content/posts/ -name "*.md" -type f -exec ls -la {} \; | tail -3
